nrow(filter(sleeping.data, SepHelpsUsStayTogether == "Somewhat disagree")),
nrow(filter(sleeping.data, SepHelpsUsStayTogether == "Neither agree nor disagree")),
nrow(filter(sleeping.data, SepHelpsUsStayTogether == "Somewhat agree")),
nrow(filter(sleeping.data, SepHelpsUsStayTogether == "Strongly agree")))
row.names(resonsAlone) <- c("One of us makes frequent bathroom trips in the night",
"One of us is sick",
"We are no longer physically intimate",
"We have different temperature preferences for the room",
"We've had an argument or fight",
"Not enough space",
"Do not want to share the covers",
"One of us needs to sleep with a child",
"Night working/very different sleeping times",
"Other")
# --------------------------------------------Graph Tab 1-----------------------------------------------------------------
reasonsAlone <- select(sleeping.data, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)
row.names(resonsAlone) <- c("One of us makes frequent bathroom trips in the night",
"One of us is sick",
"We are no longer physically intimate",
"We have different temperature preferences for the room",
"We've had an argument or fight",
"Not enough space",
"Do not want to share the covers",
"One of us needs to sleep with a child",
"Night working/very different sleeping times",
"Other")
row.names(reasonsAlone) <- c("One of us makes frequent bathroom trips in the night",
"One of us is sick",
"We are no longer physically intimate",
"We have different temperature preferences for the room",
"We've had an argument or fight",
"Not enough space",
"Do not want to share the covers",
"One of us needs to sleep with a child",
"Night working/very different sleeping times",
"Other")
rownames(reasonsAlone) <- c("One of us makes frequent bathroom trips in the night",
"One of us is sick",
"We are no longer physically intimate",
"We have different temperature preferences for the room",
"We've had an argument or fight",
"Not enough space",
"Do not want to share the covers",
"One of us needs to sleep with a child",
"Night working/very different sleeping times",
"Other")
row.names(reasonsAlone) <- c("One of us makes frequent bathroom trips in the night",
"One of us is sick",
"We are no longer physically intimate",
"We have different temperature preferences for the room",
"We've had an argument or fight",
"Not enough space",
"Do not want to share the covers",
"One of us needs to sleep with a child",
"Night working/very different sleeping times",
"Other")
rowLabels <- c("One of us makes frequent bathroom trips in the night",
"One of us is sick",
"We are no longer physically intimate",
"We have different temperature preferences for the room",
"We've had an argument or fight",
"Not enough space",
"Do not want to share the covers",
"One of us needs to sleep with a child",
"Night working/very different sleeping times",
"Other")
row.names(reasonsAlone) <- rowLabels
row.names(reasonsAlone) <- "One of us makes frequent bathroom trips in teh night"
reasonsAlone$R1 <- "One of us makes frequent bathroom trips in the night"
View(reasonsAlone)
R1 <- "One of us makes frequent bathroom trips in the night"
View(reasonsAlone)
row.name(R1) <- "One of us makes frequent bathroom trips in the night"
row.names(R1) <- "One of us makes frequent bathroom trips in the night"
row.names(reasonsAlone) <- "One of us makes frequent bathroom trips in the night"
# --------------------------------------------Graph Tab 1-----------------------------------------------------------------
reasonsAlone <- select(sleeping.data, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)
View(reasonsAlone)
colnames(reasonsAlone) <- c("One of us makes frequent bathroom trips in the night",
"One of us is sick",
"We are no longer physically intimate",
"We have different temperature preferences for the room",
"We've had an argument or fight",
"Not enough space",
"Do not want to share the covers",
"One of us needs to sleep with a child",
"Night working/very different sleeping times",
"Other")
ggplot(data = reasonsAlone) + geom_bar(mapping = aes(x = colnames(reasonsAlone))) + coord_flip()
ggplot(data = reasonsAlone) + geom_bar(mapping = aes(x = reasonsAlone)) + coord_flip()
ggplot(data = reasonsAlone) + geom_bar(mapping = + coord_flip()
# --------------------------------------------Graph Tab 2-----------------------------------------------------------------
# Plotting code for graph 2 tab pie charts
pieLabels <- c("Strongly disagree", "Somewhat disagree", "Neighter agree nor disagree", "Somewhat agree", "Strongly agree")
stayTogetherSlices <- c(nrow(filter(sleeping.data, SepHelpsUsStayTogether == "Strongly disagree")),
nrow(filter(sleeping.data, SepHelpsUsStayTogether == "Somewhat disagree")),
nrow(filter(sleeping.data, SepHelpsUsStayTogether == "Neither agree nor disagree")),
nrow(filter(sleeping.data, SepHelpsUsStayTogether == "Somewhat agree")),
nrow(filter(sleeping.data, SepHelpsUsStayTogether == "Strongly agree")))
stayTogetherPct <- round(stayTogetherSlices/sum(stayTogetherSlices)*100)
stayTogetherLabels <- paste0(pieLabels, " ", stayTogetherPct, "%")
output$stayTogetherPie <- renderPlot({
pie(stayTogetherSlices, labels = stayTogetherLabels, main = "\"Sleeping in separate beds helps us to stay together.\"")
})
betterSleepSlices <- c(nrow(filter(sleeping.data, SepHelpsMeSleepBetter == "Strongly disagree")),
nrow(filter(sleeping.data, SepHelpsMeSleepBetter == "Somewhat disagree")),
nrow(filter(sleeping.data, SepHelpsMeSleepBetter == "Neither agree nor disagree")),
nrow(filter(sleeping.data, SepHelpsMeSleepBetter == "Somewhat agree")),
nrow(filter(sleeping.data, SepHelpsMeSleepBetter == "Strongly agree")))
betterSleepPct <- round(betterSleepSlices/sum(betterSleepSlices)*100)
betterSleepLabels <- paste0(pieLabels, " ", betterSleepPct, "%")
output$betterSleepPie <- renderPlot({
pie(betterSleepSlices, labels = betterSleepLabels, main = "\"We sleep better when we sleep in separate beds.\"")
})
improvedSexSlices <- c(nrow(filter(sleeping.data, SepImprovesSexLife == "Strongly disagree")),
nrow(filter(sleeping.data, SepImprovesSexLife == "Somewhat disagree")),
nrow(filter(sleeping.data, SepImprovesSexLife == "Neither agree nor disagree")),
nrow(filter(sleeping.data, SepImprovesSexLife == "Somewhat agree")),
nrow(filter(sleeping.data, SepImprovesSexLife == "Strongly agree")))
improvedSexPct <- round(improvedSexSlices/sum(improvedSexSlices)*100)
improvedSexLabels <- paste0(pieLabels, " ", improvedSexPct, "%")
output$improvedSexPie <- renderPlot({
pie(improvedSexSlices, labels = improvedSexLabels, main = "\"Our sex life has improved as a result of sleeping in separate beds.\"")
})
# --------------------------------------------Pattern Analyzation-----------------------------------------------------------------
# --------------------------------------------Conclusion-----------------------------------------------------------------
})
ggplot(data = reasonsAlone) + geom_bar() = + coord_flip()
ggplot(data = reasonsAlone) + geom_bar() + coord_flip()
ggplot(data = reasonsAlone) + geom_bar(aes(x = reasonsAlone)) + coord_flip()
ggplot(reasonsAlone, aes(reasonsAlone)) + geom_bar() + coord_flip()
ggplot(reasonsAlone) + geom_bar() + coord_flip()
ggplot(reasonsAlone) + geom_bar(aes(x= reasonsAlone)) + coord_flip()
reasonsAlone
colnames(reasonsAlone)
ggplot(reasonsAlone) + geom_bar(aes(x= colnames(reasonsAlone))) + coord_flip()
reasonsAlone <- gather(reasonsAlone, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)
# --------------------------------------------Graph Tab 1-----------------------------------------------------------------
reasonsAlone <- select(sleeping.data, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)
reasonsAlone <- gather(reasonsAlone, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)
# --------------------------------------------Graph Tab 1-----------------------------------------------------------------
reasonsAlone <- select(sleeping.data, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)
barNums <- c(nrow(filter(reasonsAlone, R1 == "One of us makes frequent bathroom trips in the night")),
nrow(filter(reasonsAlone, R1 == "One of us makes frequent bathroom trips in the night")),
nrow(filter(reasonsAlone, R1 == "One of us makes frequent bathroom trips in the night")),
nrow(filter(reasonsAlone, R1 == "One of us makes frequent bathroom trips in the night")),
nrow(filter(reasonsAlone, R1 == "One of us makes frequent bathroom trips in the night")),
)
barNums <- c(nrow(filter(reasonsAlone, R1 == "One of us makes frequent bathroom trips in the night")),
nrow(filter(reasonsAlone, R2 == "One of us is sick")),
nrow(filter(reasonsAlone, R3 == "We are no longer physically intimate")),
nrow(filter(reasonsAlone, R4 == "We have different temperature preferences for the room")),
nrow(filter(reasonsAlone, R5 == "We've had an argument or fight")),
nrow(filter(reasonsAlone, R6 == "Not enough space")),
nrow(filter(reasonsAlone, R7 == "Do not want to share the covers")),
nrow(filter(reasonsAlone, R8 == "One of us needs to sleep with a child")),
nrow(filter(reasonsAlone, R9 == "Night working/very different sleeping times")),
nrow(filter(reasonsAlone, R10 == "Other"))
)
#ggplot(reasonsAlone) + geom_bar(aes(x= colnames(reasonsAlone))) + coord_flip()
barplot(barNums, names.arg = colnames(reasonsAlone))
#ggplot(reasonsAlone) + geom_bar(aes(x= colnames(reasonsAlone))) + coord_flip()
barplot(barNums, names.arg = colnames(reasonsAlone), horiz = TRUE)
colnames(reasonsAlone) <- c("One of us makes frequent bathroom trips in the night",
"One of us is sick",
"We are no longer physically intimate",
"We have different temperature preferences for the room",
"We've had an argument or fight",
"Not enough space",
"Do not want to share the covers",
"One of us needs to sleep with a child",
"Night working/very different sleeping times",
"Other")
#ggplot(reasonsAlone) + geom_bar(aes(x= colnames(reasonsAlone))) + coord_flip()
barplot(barNums, names.arg = colnames(reasonsAlone), horiz = TRUE)
# --------------------------------------------Graph Tab 1-----------------------------------------------------------------
reasonsAlone <- select(sleeping.data, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)
shortData <- data.frame(colnames(reasonsAlone))
View(shortData)
shortData <- data.frame("One of us makes frequent bathroom trips in the night",
"One of us is sick",
"We are no longer physically intimate",
"We have different temperature preferences for the room",
"We've had an argument or fight",
"Not enough space",
"Do not want to share the covers",
"One of us needs to sleep with a child",
"Night working/very different sleeping times",
"Other")
View(shortData)
runApp()
reasonsAlone <- filter(sleeping.data, R1 == "One of us makes frequent bathroom trips in the night",
R2 == "One of us is sick",
R3 == "We are no longer physically intimate",
R4 == "We have different temperature preferences for the room",
R5 == "We've had an argument or fight",
R6 == "Not enough space",
R7 == "Do not want to share the covers",
R8 == "One of us needs to sleep with a child",
R9 == "Night working/very different sleeping times",
R10 == "Other")
reasonsAlone <- filter(sleeping.data, R1 == "One of us makes frequent bathroom trips in the night") %>%
filter(R2 == "One of us is sick") %>%
filter(R3 == "We are no longer physically intimate") %>%
filter(R4 == "We have different temperature preferences for the room") %>%
filter(R5 == "We've had an argument or fight") %>%
filter(R6 == "Not enough space") %>%
filter(R7 == "Do not want to share the covers") %>%
filter(R8 == "One of us needs to sleep with a child") %>%
filter(R9 == "Night working/very different sleeping times") %>%
filter(R10 == "Other")
# --------------------------------------------Graph Tab 1-----------------------------------------------------------------
reasonsAlone <- select(sleeping.data, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)
reasonsAlone <- filter(sleeping.data, R1 == "One of us makes frequent bathroom trips in the night") %>%
filter(R2 == "One of us is sick") %>%
filter(R3 == "We are no longer physically intimate") %>%
filter(R4 == "We have different temperature preferences for the room") %>%
filter(R5 == "We've had an argument or fight") %>%
filter(R6 == "Not enough space") %>%
filter(R7 == "Do not want to share the covers") %>%
filter(R8 == "One of us needs to sleep with a child") %>%
filter(R9 == "Night working/very different sleeping times") %>%
filter(R10 == "Other")
# --------------------------------------------Graph Tab 1-----------------------------------------------------------------
reasonsAlone <- select(sleeping.data, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)
reasonsAlone <- filter(sleeping.data, R1 == "One of us makes frequent bathroom trips in the night") %>%
filter(R2 == "One of us is sick") %>%
filter(R3 == "We are no longer physically intimate") %>%
filter(R4 == "We have different temperature preferences for the room") %>%
filter(R5 == "We've had an argument or fight") %>%
filter(R6 == "Not enough space") %>%
filter(R7 == "Do not want to share the covers") %>%
filter(R8 == "One of us needs to sleep with a child") %>%
filter(R9 == "Night working/very different sleeping times") %>%
filter(R10 == "Other")
# --------------------------------------------Graph Tab 1-----------------------------------------------------------------
reasonsAlone <- select(sleeping.data, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)
reasonsAlone <- filter(sleeping.data, R1 == "One of us makes frequent bathroom trips in the night")
# --------------------------------------------Graph Tab 1-----------------------------------------------------------------
reasonsAlone <- select(sleeping.data, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)
reasonsAlone <- filter(reasonsAlone, R1 == "One of us makes frequent bathroom trips in the night")
# --------------------------------------------Graph Tab 1-----------------------------------------------------------------
reasonsAlone <- select(sleeping.data, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)
reasons <- c("One of us makes frequent bathroom trips in the night",
"One of us is sick",
"We are no longer physically intimate",
"We have different temperature preferences for the room",
"We've had an argument or fight",
"Not enough space",
"Do not want to share the covers",
"One of us needs to sleep with a child",
"Night working/very different sleeping times",
"Other")
data.frame(reasons, barNums)
install.packages("reshape2")
library(reshape2)
graphData <- melt(shortData, "reasons", "barNums")
# --------------------------------------------Graph Tab 1-----------------------------------------------------------------
reasonsAlone <- select(sleeping.data, reasons, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)
# --------------------------------------------Graph Tab 1-----------------------------------------------------------------
reasonsAlone <- select(sleeping.data, Reasons, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)
library(shiny)
library(dplyr)
library(ggplot2)
library(stringr)
library(tidyr)
library(scales)
# Read in the file and change column names
sleeping.data <- read.csv(file = "sleeping.data.csv", header = TRUE, sep = ",", stringsAsFactors = FALSE)
colnames(sleeping.data) <- c("StartDate", "EndDate", "RelationshipStatus", "CurrentRelationshipLength", "HowOftenSleepingSeparate",
"WhereDoYouSleep", "Other1", "WherePartnerSleeps", "Other2", "Reasons", "R1", "R2", "R3", "R4", "R5",
"R6", "R7", "R8", "R9", "R10", "FirstTimeSleepingSep", "SepHelpsUsStayTogether", "SepHelpsMeSleepBetter",
"SepImprovesSexLife", "Occupation", "O1", "Gender", "Age", "HouseholdIncome", "Education", "Location")
sleeping.data <- sleeping.data[-(1), ] # Remove header row with ("Response")
shinyServer(function(input, output) {
# --------------------------------------------Introduction-----------------------------------------------------------------
# --------------------------------------------Background Information-------------------------------------------------------
# DataFrame alterations for Background Graph
sleeping.data$CurrentRelationshipLength <- str_replace_all(sleeping.data$CurrentRelationshipLength, "Less than 1 year", "0-1 year")
sleeping.data$CurrentRelationshipLength[sleeping.data$CurrentRelationshipLength == ""] <- 'No Response'
sleeping.data$Education[sleeping.data$Education == ""] <- 'No Response'
sleeping.data$HouseholdIncome[sleeping.data$HouseholdIncome == ""] <- 'No Response'
# Reordering the levels (order) of the Education and Household Income columns
sleeping.data$Education <- factor(sleeping.data$Education, levels = c("Less than high school degree",
"High school degree", "Some college or Associate degree",
"Bachelor degree",
"Graduate degree",
"No Response"))
sleeping.data$HouseholdIncome <- factor(sleeping.data$HouseholdIncome, levels = c("$0 - $24,999",
"$25,000 - $49,999",
"$50,000 - $99,999",
"$100,000 - $149,999",
"$150,000+",
"No Response"))
# Plotting code for background information graph
output$backgroundGraph <- renderPlot({
ggplot(data = sleeping.data) + geom_bar(mapping = aes_string(x = input$dataVariable, fill = input$dataVariable)) +
ggtitle("Background Information") + labs(x = "Variable", y = "Count") + coord_flip() +
theme(panel.background = element_rect(fill = 'grey')) +
scale_fill_manual(values=c("#FF8C94", "#FFAAA6", "#FFD3B5", "#DCEDC2", "#A8E6CE", "#C4FAF8", "#ACE7FF"))
})
# DataFrome alterations for Background Pie Chart
sleeping.data$Gender[sleeping.data$Gender == ""] <- 'No Response'
sleeping.data$Age[sleeping.data$Age == ""] <- 'No Response'
# Reordering the levels (order) of the Gender and Age columns
sleeping.data$Gender <- factor(sleeping.data$Gender, levels = c("No Response",
"Female",
"Male"))
sleeping.data$Age <- factor(sleeping.data$Age, levels = c("No Response",
"18-29",
"30-44",
"45-60",
"> 60"))
# Create a blank theme for piechart
blank_theme <- theme_minimal() + theme(
plot.title = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.border = element_blank(),
panel.grid = element_blank(),
axis.ticks = element_blank()
)
# Plotting code for background information pie chart
output$backgroundPie <- renderPlot({
ggplot(data = sleeping.data, aes_string(x = factor(input$ageOrGender), fill = input$ageOrGender)) +
geom_bar(width = 1) +
coord_polar("y") +
blank_theme +
scale_fill_manual(values=c("#CCCCCC", "#FF9999", "#33CCFF", "#3399CC", "#33CCCC"))
})
# --------------------------------------------Graph Tab 1-----------------------------------------------------------------
reasons <- c("One of us makes frequent bathroom trips in the night",
"One of us is sick",
"We are no longer physically intimate",
"We have different temperature preferences for the room",
"We've had an argument or fight",
"Not enough space",
"Do not want to share the covers",
"One of us needs to sleep with a child",
"Night working/very different sleeping times",
"Other")
ggplot(reasonsAlone) + geom_bar(aes(x= colnames(reasonsAlone))) + coord_flip()
sleeping.data.stacked <- select(sleeping.data, Reasons, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)
sleeping.data.stacked <- stack(sleeping.data.stacked)
sleeping.data.stacked <- select(sleeping.data.stacked, values)
sleeping.data.stacked <- filter(sleeping.data.stacked, values != "")
# --------------------------------------------Graph Tab 2-----------------------------------------------------------------
# Plotting code for graph 2 tab pie charts
pieLabels <- c("Strongly disagree", "Somewhat disagree", "Neighter agree nor disagree", "Somewhat agree", "Strongly agree")
stayTogetherSlices <- c(nrow(filter(sleeping.data, SepHelpsUsStayTogether == "Strongly disagree")),
nrow(filter(sleeping.data, SepHelpsUsStayTogether == "Somewhat disagree")),
nrow(filter(sleeping.data, SepHelpsUsStayTogether == "Neither agree nor disagree")),
nrow(filter(sleeping.data, SepHelpsUsStayTogether == "Somewhat agree")),
nrow(filter(sleeping.data, SepHelpsUsStayTogether == "Strongly agree")))
stayTogetherPct <- round(stayTogetherSlices/sum(stayTogetherSlices)*100)
stayTogetherLabels <- paste0(pieLabels, " ", stayTogetherPct, "%")
output$stayTogetherPie <- renderPlot({
pie(stayTogetherSlices, labels = stayTogetherLabels, main = "\"Sleeping in separate beds helps us to stay together.\"")
})
betterSleepSlices <- c(nrow(filter(sleeping.data, SepHelpsMeSleepBetter == "Strongly disagree")),
nrow(filter(sleeping.data, SepHelpsMeSleepBetter == "Somewhat disagree")),
nrow(filter(sleeping.data, SepHelpsMeSleepBetter == "Neither agree nor disagree")),
nrow(filter(sleeping.data, SepHelpsMeSleepBetter == "Somewhat agree")),
nrow(filter(sleeping.data, SepHelpsMeSleepBetter == "Strongly agree")))
betterSleepPct <- round(betterSleepSlices/sum(betterSleepSlices)*100)
betterSleepLabels <- paste0(pieLabels, " ", betterSleepPct, "%")
output$betterSleepPie <- renderPlot({
pie(betterSleepSlices, labels = betterSleepLabels, main = "\"We sleep better when we sleep in separate beds.\"")
})
improvedSexSlices <- c(nrow(filter(sleeping.data, SepImprovesSexLife == "Strongly disagree")),
nrow(filter(sleeping.data, SepImprovesSexLife == "Somewhat disagree")),
nrow(filter(sleeping.data, SepImprovesSexLife == "Neither agree nor disagree")),
nrow(filter(sleeping.data, SepImprovesSexLife == "Somewhat agree")),
nrow(filter(sleeping.data, SepImprovesSexLife == "Strongly agree")))
improvedSexPct <- round(improvedSexSlices/sum(improvedSexSlices)*100)
improvedSexLabels <- paste0(pieLabels, " ", improvedSexPct, "%")
output$improvedSexPie <- renderPlot({
pie(improvedSexSlices, labels = improvedSexLabels, main = "\"Our sex life has improved as a result of sleeping in separate beds.\"")
})
# --------------------------------------------Pattern Analyzation-----------------------------------------------------------------
# Data Frame alterations for Pattern Analyzation graph
sleeping.data$HowOftenSleepingSeparate[sleeping.data$HowOftenSleepingSeparate == ""] <- 'No Response'
# Reordering the levels (order) of the HowOftenSleepingSeparate and RelationshipStatus columns
sleeping.data$HowOftenSleepingSeparate <- factor(sleeping.data$HowOftenSleepingSeparate,
levels = c("Every night",
"A few times per week",
"A few times per month",
"Once a month or less",
"Once a year or less",
"Never",
"No Response"))
sleeping.data$RelationshipStatus <- factor(sleeping.data$RelationshipStatus,
levels = c("Single, but cohabiting with a significant other",
"In a domestic partnership or civil union",
"Married",
"Separated",
"Divorced",
"Widowed"))
# Plotting code for Pattern Analyzation bar graph
output$analyticsGraph <- renderPlot({
ggplot(data = sleeping.data) + geom_bar(mapping = aes_string(x = input$analyticsVariable, fill = "HowOftenSleepingSeparate")) +
ggtitle("") + labs(x = "Variable", y = "Count") + coord_flip() +
theme(panel.background = element_rect(fill = 'grey')) +
scale_fill_manual(values=c("#FF8C94", "#FFAAA6", "#FFD3B5", "#DCEDC2", "#A8E6CE", "#C4FAF8", "#ACE7FF"))
})
# --------------------------------------------Conclusion-----------------------------------------------------------------
})
sleeping.data.stacked <- select(sleeping.data, Reasons, R1, R2, R3, R4, R5, R6, R7, R8, R9, R10)
sleeping.data.stacked <- stack(sleeping.data.stacked)
sleeping.data.stacked <- select(sleeping.data.stacked, values)
sleeping.data.stacked <- filter(sleeping.data.stacked, values != "")
View(sleeping.data.stacked)
ggplot(sleeping.data.stacked) +geom_bar(aes(x = values)) + coord_flip()
sleeping.data.stacked$values[sleeping.data.stacked$values == "Other (please specify)"] <- 'Other'
ggplot(sleeping.data.stacked) +geom_bar(aes(x = values)) + coord_flip()
runApp()
runApp()
runApp()
runApp()
runApp()
ggplot(sleeping.data.stacked) + geom_bar(aes(x = values)) + coord_flip() +
scale_fill_manual(values=c("#FF8C94", "#FFAAA6", "#FFD3B5", "#DCEDC2", "#A8E6CE", "#C4FAF8", "#ACE7FF"))
ggplot(sleeping.data.stacked) + geom_bar(aes(x = values)) + coord_flip() +
scale_fill_manual(values=c("#FF8C94", "#FFAAA6", "#FFD3B5", "#DCEDC2", "#A8E6CE", "#C4FAF8", "#ACE7FF", "#85E3FF",
"#6EB5FF", "#DCD3FF", "#B5B9FF"))
runApp()
ggplot(sleeping.data.stacked) + geom_bar(aes(x = values, fill= values)) + coord_flip() +
scale_fill_manual(values=c("#FF8C94", "#FFAAA6", "#FFD3B5", "#DCEDC2", "#A8E6CE", "#C4FAF8", "#ACE7FF", "#85E3FF",
"#6EB5FF", "#DCD3FF", "#B5B9FF"))
runApp()
ggplot(sleeping.data.stacked) + geom_bar(aes(x = values, fill= values,)) + coord_flip() + guides(fill=FALSE)
runApp()
ggplot(sleeping.data.stacked) + geom_bar(aes(x = values, fill= values,)) + coord_flip() + guides(fill=FALSE) +
scale_fill_manual(values=c("#FF8C94", "#FFAAA6", "#FFD3B5", "#DCEDC2", "#A8E6CE", "#C4FAF8", "#ACE7FF", "#85E3FF",
"#6EB5FF", "#DCD3FF", "#B5B9FF"))
runApp()
shinyUI(navbarPage("Sleeping Alone",
# --------------------------------------------Introduction-----------------------------------------------------------------
tabPanel("Intro", fluidPage(
includeMarkdown("Intro.Rmd")
)),
# --------------------------------------------Background Information-------------------------------------------------------
tabPanel("Background", fluidPage(
titlePanel("Data Statistics"),
sidebarLayout(
sidebarPanel(
# dataVariable Widget
selectInput('dataVariable', "Histogram Variable:",
list("Years Together" = "CurrentRelationshipLength",
"Education" = "Education",
"Income" = "HouseholdIncome")),
# Age or Gender Widget
selectInput('ageOrGender', "Pie Chart Variable:",
list("Gender" = "Gender",
"Age" = "Age"))
),
# Main Panel
mainPanel(
plotOutput("backgroundGraph"),
plotOutput("backgroundPie")
)
))
),
# --------------------------------------------Graph Tab 1-----------------------------------------------------------------
tabPanel("Graph", fluidPage(
titlePanel("Sleep Trends"),
p("Partipants were asked to choose the reasons they would sleep alone. These are the results:"),
mainPanel(
plotOutput("graph1Bar")
)
)
),
# --------------------------------------------Graph Tab 2-----------------------------------------------------------------
tabPanel("Graph", fluidPage(
titlePanel("Participant Opinions on Sleeping Separately"),
p("Participants were asked to choose from a range of \"Strongly Agree\" to \"Strongly Disagree\" to the
following statements:"),
p("- \"Sleeping in separate beds helps us to stay together.\""),
p("- \"We sleep better when we sleep in separate beds.\""),
p("- \"Our sex life has improved as a result of sleeping in separate beds.\"")
), fluidRow(
# pie charts
column(width = 4, plotOutput('stayTogetherPie')),
column(width = 4, plotOutput('betterSleepPie')),
column(width = 4, plotOutput('improvedSexPie'))
)),
# --------------------------------------------Pattern Analyzation-----------------------------------------------------------------
tabPanel("Pattern Analyzation" , fluidPage(
titlePanel("How Different Variables Potentially Affect Frequency of Sleeping Alone"),
sidebarLayout(
sidebarPanel(
# Variable Widget
selectInput('analyticsVariable', "Variable:",
list("Income" = "HouseholdIncome",
"Age" = "Age",
"Education" = "Education",
"Gender" = "Gender",
"Relationship Status" = "RelationshipStatus",
"Time Together" = "CurrentRelationshipLength"))
),
# Main Panel, Render the Graph
mainPanel(
plotOutput("analyticsGraph")
)
))),
# --------------------------------------------Conclusion-----------------------------------------------------------------
tabPanel("Conclusion", fluidPage(
#conclusion statements here
))
))
runApp()
runApp()
